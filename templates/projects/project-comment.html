{% load static %} {% load custom_project_tags %}
{% if request.user.is_authenticated %}
    {% if 'projects/actions/' in request.path %}
        <div class="border-top-solid-teal border-bottom-solid-teal flex-this space-between">
            <h2>Project messages</h2>
            <h2 class="margin-right-8 pointer" onclick="toggleProjectInfo(this, 'projectMessageDiv')"><i class="fa-solid fa-minus fa-xl darkteal-text"></i></h2>
        </div>
        <div id="projectMessageDiv" style="height: auto; overflow: hidden;">
            <div>
                {% if institution or community %}
                    {% if member_role == 'admin' or member_role == 'editor' %}
                        {% include 'snippets/comment-box.html' %}
                    {% endif %} 
                {% endif %}

                {% if researcher %}
                    {% include 'snippets/comment-box.html' %}
                {% endif %}

                {% for comment in comments %}
                    <div class="border-top-grey">
                        <p>
                            <span class="bold">
                                {% firstof comment.sender.get_full_name comment.sender.username %} 
                                {% if comment.sender_affiliation %} | {{ comment.sender_affiliation }} {% endif %}
                            </span> <span class="grey-text">{{ comment.created|date:'m/d/Y' }}</span><br><br>
                            {{ comment.message }}
                        </p>
                    </div>
                {% empty %}
                    <p class="center-text"><small>No messages yet</small></p>
                {% endfor %}
            </div>
        </div>
    {% endif %}
{% endif %}
