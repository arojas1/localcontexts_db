{% extends 'comm-base.html' %} {% load static %} {% block community_content %}

    <div class="content-card content-card-space white-bg ">
        <h3 class="orange-text reqs">Requests</h3>
    </div>

    {% if notices %}
    {% for notice in notices %}

    <!-- TODO: clarify this flow, new figma card -->
    <div class="content-card content-card-space white-bg">
        <div class="flex-this">
            <div class="w-15">
                <img src="{% static 'images/notices/bc-notice.png' %}" alt="BC Notice: black square with BC in white letters in the middle">
            </div>

            <div class="w-90">
                <p>
                    <span class="darkteal-text weight-600">{{ notice.project.title}}</span><br>
                    {{ notice.project.publication_date }} <br>
                    {{ notice.project.project_type }} <br>
                    {% for contributor in notice.communities.all %}
                        {{ contributor.community_name }}
                    {% endfor %}, 
                    {% if notice.placed_by_institution %}
                        {{ notice.placed_by_institution.institution_name }}
                    {% else %}
                        {{ notice.placed_by_researcher.user.get_full_name}}
                    {% endif %}
                </p>
            </div>
            <div class="w-15">
                <a href="#" class="action-btn">
                    Show More <i class="fa fa-angle-down" aria-hidden="true"></i>
                </a>
            </div>
        </div>
    </div>

    <!-- Original figma card -->
        <div class="content-card content-card-space white-bg">

            <div class="flex-this w-100 notice-top">
                <div class="w-70">
                    <p>A BC notice has been placed by <a href="#" class="darkteal-text">
                        {% if notice.placed_by_institution %}
                            {{ notice.placed_by_institution.institution_name }}
                        {% else %}
                            {{ notice.placed_by_researcher.user.get_full_name}}
                        {% endif %}
                    </a></p>
                </div>
    
                <div class="w-15 auto-margin flex-this flex-end">
                    <button class="action-btn">Label Pending</button>
                </div>
                <div class="w-15 auto-margin flex-this flex-end">
                    <a href="#" class="darkteal-text">Notice Acknowledged</a>
                </div>
                <div class="w-5 auto-margin flex-this flex-end">
                    <span class="darkteal-text weight-500">+</span>
                </div>
            </div>
    
    
            <div class="flex-this notice-card">
    
                <div class="flex-this column w-15 notice-btns">
                    <div>
                        <img src="{% static 'images/notices/bc-notice.png' %}" alt="BC Notice: black square with BC in white letters in the middle">
                    </div>
                    <div>
                        <a href="{% url 'community-add-labels' community.id notice.id %}">
                            <button class="action-btn">Attach Labels</button>
                        </a>
                    </div>
                    {% if notice.project.geome_project_id %}
                        <div>
                            <button class="green-action-btn">View on GEOME </button>   
                        </div>
                    {% endif %}
                    <div>
                        <button class="green-action-btn">View ORCiD</button>    
                    </div>
                </div>
        
                <div class="w-40 notice-info">
                    <a href="#"><h4 class="darkteal-text weight-500">{{ notice.project.title}}</h4></a>
        
                    <p>
                        Expedition<br>
                        Notice Applied: {{ notice.created.date }}<br>
                        Source: NIWA via GEOME<br>
                    </p>
                    <p>
                        <span class="weight-500">Contact Us:</span><br>
                    {% if notice.placed_by_institution %}
                        Website: {{ notice.placed_by_institution.website }}<br>
                        Email: {{ notice.placed_by_institution.contact_email }}<br>
                        Postal Address: {{ notice.placed_by_institution.address }}<br>
                        Phone: {{ notice.placed_by_institution.contact_number }}<br>
                    {% else %}
                        Website: {{ notice.placed_by_researcher.website }}<br>
                        Email: {{ notice.placed_by_researcher.contact_email }}<br>
                        Phone: {{ notice.placed_by_researcher.contact_number }}<br>
                    {% endif %}
                    </p>
                </div>
        
                <div class="w-50 notice-msg">
                    <h4 class="weight-500">Message Sent by <a href="#" class="darkteal-text">
                    {% if notice.placed_by_institution %}
                        {{ notice.placed_by_institution.institution_name }}
                    {% else %}
                        {{ notice.placed_by_researcher.user.get_full_name}}
                    {% endif %}
                    </a>:</h4>
                    <p>
                        {{ notice.message|linebreaks }}
                    </p>
                </div>
            </div>
    
        </div>
        {% endfor %}
    {% else %}
        <div class="content-card content-card-space white-bg">
            <p>No notices to display at this time</p>
        </div>
    {% endif %}

{% endblock %}