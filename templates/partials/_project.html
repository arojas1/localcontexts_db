{% load static %}

<div class="content-card-v2 content-card-space white-bg">

    <div class="flex-this w-100">
        <div class="flex-this w-50">
            {% if request.user.is_authenticated %}
                <div><a class="primary-btn green-btn margin-top-2" onClick="window.history.back();return false;"><i class="fa fa-arrow-left"></i> Back to Projects</a></div>
            {% endif %}
        </div>

        <div class="flex-this flex-end w-50">
            <div class="margin-left-8"><a class="primary-btn white-btn margin-top-2" href="{% url 'download-project-zip' project.unique_id %}">Download <i class="fa fa-download" aria-hidden="true"></i></a></div>
        </div>

    </div>


    <div class="flex-this space-between w-100">
        <div class="flex-this column">
            <div class="margin-top-1">
                <p class="p-24 bold">Project View</p>
                <p>Listed below is the information that is associated with this Project.<br>
                    If you would like to edit this Project, you can do so until a community has applied a Label to this Project. </p>
            </div>
        </div>
    </div>

</div>

<div class="content-card-v2 content-card-space white-bg">
    
    <div class="flex-this margin-right-1 margin-left-1">
        <div class="flex-this column w-60">
            <div><p class="p-28 bold">{{ project.title }}</p></div>
            <div><p class="bold">{{ project.date_added|date:'d F Y' }} | {{ project.project_type }} | {{ project.project_privacy }}</p></div>

            <div>
                <p class="p-24 bold no-top-margin">Project Information</p>
                <span class="bold">Project Description</span><br>
                <p>{{ project.description }}</p>
            </div>

            <div>
                <p class="bold">Project Contact</p>
                <p>
                    Name | {{ project.project_contact }} <br>
                    Email | {{ project.project_contact_email }}
                </p>
            </div>

            <div>
                <p class="bold">Project Contributors</p>
                <p>
                    <ul>
                        {% if project.project_contributors.communities %}
                            {% for community in project.project_contributors.communities.all %}
                                <li>{{ community.community_name }} | Community</li>
                            {% endfor %}
                        {% endif %}

                        {% if project.project_contributors.institutions %}
                            {% for institution in project.project_contributors.institutions.all %}
                                <li>{{ institution.institution_name }} | Institution <br></li>
                            {% endfor %}
                        {% endif %}

                        {% if project.project_contributors.researchers %}
                            {% for researcher in project.project_contributors.researchers.all %}
                                <li>
                                    <div class="researcher-hover">
                                        {% if researcher.orcid %}
                                            <a class="darkteal-text" itemprop="sameAs" content="{{ researcher.orcid }}" href="{{ researcher.orcid }}" target="orcid.widget" rel="me noopener noreferrer" style="vertical-align:top;">
                                                <img loading="lazy" src="https://orcid.org/sites/default/files/images/orcid_16x16.png" style="margin-top:2.5px;" alt="ORCID iD icon">
                                            </a>
                                        {% endif %}
                                        {{ researcher.user.get_full_name }} | Researcher
                                        <div class="researcher-hover-info">
                                            <p>
                                                <strong>Primary Institution Affiliation:</strong> {% if researcher.primary_institution %}{{ researcher.primary_institution }}{% else %} None specified {% endif %}<br>
                                                <strong>About:</strong> {% if researcher.description %} {{ researcher.description }} {% else %} No description available{% endif %}
                                            </p>
                                            
                                        </div>
                                    </div>
                                </li>
                            {% endfor %}
                        {% endif %}
                        {% if project.additional_contributors %}
                            {% for contributor in project.additional_contributors.all %}
                                <li>{{ contributor.name }} | Contributor </li>
                            {% endfor %}
                        {% endif %}
                    </ul>
                </p>
            </div>

            <div>
                <p class="p-24 bold no-bottom-margin">Project Identifiers</p>

                <div class="flex-this margin-top-16">
                    <div><a onclick="copyToClipboard('uniqueIDToCopy')" class="primary-btn green-btn margin-top-2 copied-display"><i class="fa fa-copy"></i></a></div>
                    <div class="margin-left-1"><p class="no-top-margin"><span class="bold">Local Contexts Project ID</span> <br><span id="uniqueIDToCopy">{{ project.unique_id }}</span><br></p></div>
                </div>

                <div class="flex-this margin-top-16">
                    {% if project.providers_id %}
                        <div><a onclick="copyToClipboard('providersIDToCopy')" class="primary-btn green-btn margin-top-2 copied-display"><i class="fa fa-copy"></i></a></div>
                        <div class="margin-left-1"><p class="no-top-margin"><span class="bold">Providers ID</span> <br><span id="providersIDToCopy">{{ project.providers_id }}</span><br></p></div>
                    {% endif %}
                </div>

                <div class="flex-this margin-top-1">
                    <div>
                        {% if project.publication_doi %}
                            {% if 'https://' not in project.publication_doi %}
                                <a href="https://www.dx.doi.org/{{ project.publication_doi }}" class="primary-btn green-btn margin-top-2"><i class="fa fa-external-link" aria-hidden="true"></i></a>
                            {% endif %}
                        {% endif %}
                    </div>
                    <div class="margin-left-1"><p class="no-top-margin"><span class="bold">Project DOI</span> <br>
                        {% if project.publication_doi %}
                            <a class="darkteal-text underline-hover" href="https://www.dx.doi.org/{{ project.publication_doi }}">{{ project.publication_doi }}</a>
                        {% else %}
                            None <br>
                        {% endif %}
                    </p></div>
                </div>

                <div class="flex-this margin-top-1">
                    <div>
                        {% if project.project_data_guid %}
                            <a onclick="copyToClipboard('guidToCopy')" class="primary-btn green-btn margin-top-2 "><i class="fa fa-copy"></i></a>
                        {% endif %}
                    </div>
                    <div class="margin-left-1"><p class="no-top-margin"><span class="bold">Project Data GUID</span><br> <span id="guidToCopy">{{ project.project_data_guid }}</span><br></p></div>
                </div>

                <div><p><span class="bold">Recommended Citation</span><br> {% if project.recommended_citation %}{{ project.recommended_citation }} {% else %} None {% endif %}<br></p></div>

            </div>
        </div>
        
        <!-- PROJECT IMAGES WILL GO HERE -->

    
    </div>

    <div class="margin-right-1 margin-left-1">
        {% if project.project_notice.all %}

                {% for notice in project.project_notice.all %}
                {% if notice.archived %} {% else %}
                    <div><p class="p-24 bold">Project Notice</p></div>

                    {% if notice.notice_type == 'biocultural' or notice.notice_type == 'biocultural_and_traditional_knowledge' %}
                        <div class="flex-this border-top-solid-teal border-bottom-solid-teal">
                            <div class="w-15 pad-top-1"><img loading="lazy" src="{{ notice.bc_img_url }}" width="78" height="78" alt="black square with white letters BC in the middle"></div>
                            <div class="w-80 pad-top-1">
                                <h3 class="no-top-margin">Biocultural Notice</h3>
                                <p>{{ notice.bc_default_text}}</p>
                            </div>
                        </div>
                    {% endif %}

                    {% if notice.notice_type == 'traditional_knowledge' or notice.notice_type == 'biocultural_and_traditional_knowledge' %}
                        <div class="flex-this border-top-solid-teal border-bottom-solid-teal">
                            <div class="w-15 pad-top-1"><img loading="lazy" src="{{ notice.tk_img_url }}" width="78" height="78" alt="black square with white letters TK in the middle"></div>
                            <div class="w-80 pad-top-1">
                                <h3 class="no-top-margin">Traditional Knowledge Notice</h3>
                                <p>{{ notice.tk_default_text}}</p>
                            </div>
                        </div>
                    {% endif %}
                {% endif %}
                    
                {% endfor %}
        {% endif %}

        {% if project.project_institutional_notice.all %}
            {% for notice in project.project_institutional_notice.all %}

                {% if notice.archived %} {% else %}
                    {% if notice.notice_type == 'attribution_incomplete' or notice.notice_type == 'open_to_collaborate_and_attribution_incomplete' %}
                        <div class="flex-this border-top-solid-teal border-bottom-solid-teal">
                            <div class="w-15 pad-top-1"><img loading="lazy" src="{{ notice.attribution_incomplete_img_url }}" width="78" height="78"></div>
                            <div class="w-80 pad-top-1">
                                <h3 class="no-top-margin">Attribution Incomplete Notice</h3>
                                <p>{{ notice.attribution_incomplete_default_text}}</p>
                            </div>
                        </div>
                    {% endif %}

                    {% if notice.notice_type == 'open_to_collaborate' or notice.notice_type == 'open_to_collaborate_and_attribution_incomplete' %}
                        <div class="flex-this border-top-solid-teal border-bottom-solid-teal">
                            <div class="w-15 pad-top-1"><img loading="lazy" src="{{ notice.open_to_collaborate_img_url }}" width="78" height="78"></div>
                            <div class="w-80 pad-top-1">
                                <h3 class="no-top-margin">Open to Collaboration Notice</h3>
                                <p>{{ notice.open_to_collaborate_default_text}}</p>
                            </div>
                        </div>
                    {% endif %}
                {% endif %}
            {% endfor %}
        {% endif %}
    </div>

    {% if project.bc_labels.all or project.tk_labels.all %}
        <div class="margin-right-1 margin-left-1">
            <div><p class="p-24 bold">Project Labels</p></div>

        {% if project.bc_labels.all %}
            {% for bclabel in project.bc_labels.all %}
                <div>
                    <div class="flex-this">
                        <div class="small-label pad-top-1-5">
                            {% include 'bclabels/which-label.html' %}
                        </div>
                        <div class="pad-left-2">
                            <p class="darkteal-text">Label shared by {{ bclabel.community.community_name }} </p>
                            <p class="bold"> {{ bclabel.name }} </p>
                            {% if bclabel.audiofile %} <div><audio src="{{ bclabel.audiofile.url }}" controls></audio></div>{% endif %}
                            <p>{{ bclabel.default_text}}</p>

                            {% include 'partials/_label-translation.html' %}
                        </div>
                    </div>
                    <div class="border-bottom-solid-teal margin-top-1"></div>
                </div>
            {% endfor %}
        {% endif %}

        {% if project.tk_labels.all %}
            {% for tklabel in project.tk_labels.all %}
                <div>
                    <div class="flex-this">
                        <div class="small-label pad-top-1-5">
                            {% include 'tklabels/which-label.html' %}
                        </div>
                        <div class="pad-left-2">
                            <p class="darkteal-text">Label shared by {{ tklabel.community.community_name }} </p>
                            <p class="bold"> {{ tklabel.name }} </p>
                            {% if tklabel.audiofile %} <div><audio src="{{ tklabel.audiofile.url }}" controls></audio></div>{% endif %}

                            <p>{{ tklabel.default_text}}</p>

                            {% include 'partials/_label-translation.html' %}
                        </div>
                    </div>
                    <div class="border-bottom-solid-teal margin-top-1"></div>
                </div>
            {% endfor %}
        {% endif %}

        </div>
    {% endif %}

</div>
