{% extends 'base.html' %} {% load static %} {% block content %} {% load custom_tags %}
{% community_notifications community as notifications %}

<div class="pad-top-8">

    <div class="content-card content-card-space flex-this column white-bg">
    
        <div class="flex-this column">
    
            <div class="flex-this w-100 space-between">
                <div class="loc">
                    <a href="{% url 'users' community.community_creator.id %}" class="darkteal-text">
                        {% if community.community_creator.first_name %}
                            {{ community.community_creator.first_name }}
                        {% else %}
                            {{ community.community_creator }}
                        {% endif %}
                    </a> 
                    >> {{ community.community_name }}
                </div>

                <div class="flex-this w-20 space-between">
                    <div class="dropdown">
                        <a onclick="toggleNotifications()" class="darkteal-text pointer dropbtn"> Notifications <i class="fa fa-bell" aria-hidden="true"></i></a>
                        <div id="notification-v2" class="notification-dropdown-content">
                            <div class="border-bottom-solid-teal center-text">
                                <span class="orange-text weight-500">{{community.community_name}} Notifications</span>
                            </div>
                            {% if notifications %}
                                {% for n in notifications %}

                                    <div class="border-bottom-solid-teal">
                                        <!-- TODO: add custom anchor tag with referenceid -->
                                        {% if n.notification_type == 'Labels' %}
                                            <a href="{% url 'community-labels' community.id %}">
                                        {% endif %}
                                        {% if n.notification_type == 'Activity' %}
                                            {% if n.reference_id %}
                                                <a href="{% anchor 'community-activity' n.reference_id community.id %}">
                                            {% else %}
                                                <a href="{% url 'community-activity' community.id %}">
                                            {% endif %}
                                        {% endif %}
                                        {% if n.notification_type == 'Projects' %}
                                            <a href="{% url 'community-projects' community.id %}">
                                        {% endif %}
                                        {% if n.notification_type == 'Connections' %}
                                            <a href="#">
                                        {% endif %}
                                        
                                            <div class="flex-this space-between margin-top-1">
                                                <div><span class="notification-type-tag orange-bg white-text font-size-12">
                                                    {% if n.notification_type == 'Notices' %}
                                                        Notices
                                                    {% endif %}
                                                    {% if n.notification_type == 'Labels' %}
                                                        Labels
                                                    {% endif %}
                                                    {% if n.notification_type == 'Activity' %}
                                                        Activity
                                                    {% endif %}
                                                    {% if n.notification_type == 'Projects' %}
                                                        Projects
                                                    {% endif %}
                                                    {% if n.notification_type == 'Connections' %}
                                                        Connections
                                                    {% endif %}
                                                </span></div>
                                                <div><span class="font-size-12 grey-text">{{ n.created }}</span></div>
                                            </div>
            
                                            <div><p class="darkteal-text font-size-14"> {{ n.title }}</p></div>    
                                        </a>
                                    </div>

                                {% endfor %}
                            {% endif %}

                            <!-- Grey Label, keep until finalized -->

                            <!-- <div class="border-bottom-solid-teal">
                                <a href="#">
                                    <div class="flex-this space-between margin-top-1">
                                        <div><span class="notification-type-tag grey white-text font-size-12">Activity</span></div>
                                        <div><span class="font-size-12 grey-text">Date</span></div>
                                    </div>

                                    <div><p class="darkteal-text font-size-14"> This is the body of the notification.</p></div>
                                </a>
                            </div> -->

                        </div>
                    </div>

                    {% if request.user == community.community_creator %}

                        <div>
                            <a href="{% url 'update-community' community.id %}" class="darkteal-text"> Settings <i class="fa fa-cog" aria-hidden="true"></i></a>
                        </div>

                    {% endif %}
                </div>
                
            </div>
    
            <div class="flex-this stats-info-container">
    
                <div class="w-30 stats-img-container">
                    {% if community.image %}
                        <img src="{{ community.image.url }}" alt="{{ community.community_name }} image">
                    {% else %}
                        <img src="{% static 'images/placeholders/community-place.jpg' %}" alt="{{ community.community_name }} image">
                    {% endif %}
                </div>
    
                <div class="flex-this column w-40">
                    <h2 class="orange-text community-title">{{ community.community_name }} </h2>
                    <p>
                        Role: <span> 
                            {% if member_role == 'admin' %}
                                Admin
                            {% endif %}
                            {% if member_role == 'editor' %}
                                Editor
                            {% endif %}
                            {% if member_role == 'viewer' %}
                                Viewer
                            {% endif %}
                        </span><br>
                        Members: <span>
                            {% if community.get_member_count < 10 %}
                                0{{ community.get_member_count }}
                            {% else %}
                                {{ community.get_member_count }}
                            {% endif %}
                            
                            </span><br>
                        Location: <span>{{ community.town }}, {{ community.country.name }} </span><br>
                        {% if request.user == community.community_creator and community.is_approved == False %}
                            <small>Your community application is being reviewed and <br> has not been approved yet.</small>
                        {% else %}
                            <small>Your community application has been approved.</small>
                        {% endif %}
                    </p>
                </div>
    
                <div class="flex-this white-text w-30">
                    <div class="orange-bg stats-card w-30">
                        <h1>
                            {% get_label_count community.id as label_count %}
                            {% if label_count < 10 %}
                                0{{ label_count }}
                            {% else %}
                                {{ label_count }}
                            {% endif %}
                        </h1>
                        <p>Labels</p>
                    </div>
    
                    <div class="orange-bg stats-card w-30">
                        <h1>{% if community.get_member_count < 10 %}
                                0{{ community.get_member_count }}
                            {% else %}
                                {{ community.get_member_count }}
                            {% endif %}
                        </h1>
                        <p>Members</p>
                    </div>
    
                    <!-- <div class="orange-bg stats-card w-30">
                        <h1>02</h1>
                        <p>Relationships</p>
                    </div> -->
                </div>
    
            </div>
    
        </div>
    
    </div>
</div>


{% endblock %}